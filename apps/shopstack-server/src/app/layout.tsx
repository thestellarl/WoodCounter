import {
  AppBar,
  Badge,
  Box,
  Container,
  IconButton,
  Link,
  ThemeProvider,
  Toolbar,
  Typography,
} from '@mui/material';
import './global.css';
import dynamic from 'next/dynamic';
import { FaSignOutAlt } from 'react-icons/fa';
import { AppRouterCacheProvider } from '@mui/material-nextjs/v13-appRouter';
import theme from './theme';
import MainBox from './main';

export const metadata = {
  title: 'Welcome to shopstack-server',
  description: 'Generated by create-nx-workspace',
};

const GoogleOAuthProviderWrapper = dynamic(
  () => import('./components/GoogleOAuthProviderWrapper'),
  { ssr: false }
);

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const handleLogout = () => {
    // Implement logout logic
    console.log('Logging out...');
  };

  return (
    <html lang="en">
      <body>
        <AppRouterCacheProvider options={{ enableCssLayer: true }}>
          <ThemeProvider theme={theme}>
            <GoogleOAuthProviderWrapper>
              <Box sx={{ display: 'flex' }}>
                <AppBar position="absolute">
                  <Toolbar
                    sx={{
                      pr: '24px',
                    }}
                  >
                    <Link href="/" underline="none" flexGrow={1}>
                      <Typography
                        variant="h2"
                        component="h1"
                        noWrap
                        sx={{
                          fontWeight: 'bold',
                          color: 'white',
                        }}
                        bold
                      >
                        ShopStack
                      </Typography>
                    </Link>
                    <IconButton color="inherit">
                      <Badge color="secondary">
                        <FaSignOutAlt />
                      </Badge>
                    </IconButton>
                  </Toolbar>
                </AppBar>
                <MainBox>
                  <Toolbar />
                  <Container maxWidth="lg" sx={{ mt: 4, mb: 4 }}>
                    {children}
                  </Container>
                </MainBox>
              </Box>
            </GoogleOAuthProviderWrapper>
          </ThemeProvider>
        </AppRouterCacheProvider>
      </body>
    </html>
  );
}
